<!DOCTYPE html>
<html lang="en">
  <div id="dynamic-content"></div>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weasel-Tech Social System Roller</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;600&display=swap');


:root {
    /* Material Design Colors */
    --primary-color: #6200ee; /* MD3 primary */
    --secondary-color: #03dac6; /* MD3 secondary */
    --background-color: #ffffff; /* Light background */
    --surface-color: #f5f5f5; /* Surface */
    --error-color: #b00020; /* Error */
    --text-color: #000000; /* Primary text */
    --text-secondary-color: #5f6368; /* Secondary text */
    --divider-color: #e0e0e0; /* Divider */
    --shadow-color: rgba(0, 0, 0, 0.2); /* Shadow */
    --border-radius: 8px;
    --padding: 16px;
    --transition-speed: 0.3s;

    /* Dynamic Typography */
    --font-size-h1: clamp(1.5rem, 2vw, 6rem);
    --font-size-h2: clamp(1.25rem, 1.5vw, 2.5rem);
    --font-size-body: clamp(1rem, 1vw, 1.5rem);
    
    
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    line-height: 1.3;
    transition: background-color var(--transition-speed), color var(--transition-speed);
    max-width: 50%; /* Restrict content to the middle half of the page */
    margin: 0 auto; /* Center the content horizontally */
}

h1, h2, h3 {
    font-weight: 500;
    color: var(--text-color);
    margin: 8px 0; /* Reduce margin for headings */
   
}

h1 {
    font-size: 1.5rem; /* Smaller font size for h1 */
}

h2 {
    font-size: 1.25rem; /* Smaller font size for h2 */
}

p, div {
    font-size: 0.9rem; /* Reduce general text size */
    margin: 6px 0; /* Smaller spacing between elements */
    color: var(--text-secondary-color);
}

textarea, input[type="number"] {
    width: calc(100% - 16px); /* Adjust width for smaller content */
    max-width: 300px; /* Limit input field width */
    padding: 8px; /* Reduce padding inside inputs */
    font-size: 0.8rem; /* Reduce font size in inputs */
    border: 1px solid var(--divider-color);
    border-radius: var(--border-radius);
    background-color: var(--surface-color);
    margin: px 0; /* Reduce vertical margin for inputs */
    box-shadow: 0px 1px 2px var(--shadow-color);
}



@media (max-width: 600px) {
    body {
        max-width: 90%; /* Adjust for mobile screens */
    }

    h1 {
        font-size: 1.25rem; /* Smaller h1 on mobile */
    }

    h2 {
        font-size: 1rem; /* Smaller h2 on mobile */
    }

    textarea, input[type="number"], button, .event {
        max-width: 100%;
        padding: 8px;
    }
}


textarea:focus, input[type="number"]:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0px 4px 8px var(--shadow-color);
}

button {
    padding: 12px 24px;
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    border-radius: var(--border-radius);
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    box-shadow: 0px 2px 4px var(--shadow-color);
    transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
    position: relative;
    overflow: hidden;
}

button:hover {
    background-color: #3700b3;
    box-shadow: 0px 4px 8px var(--shadow-color);
}

button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s, opacity 0.6s;
}

button:active::after {
    width: 200px;
    height: 200px;
    opacity: 0;
}

.event {
    background-color: var(--surface-color);
    padding: var(--padding);
    border-radius: var(--border-radius);
    margin: 16px auto;
    max-width: 100%;
    box-shadow: 0px 4px 8px var(--shadow-color);
    text-align: left;
}

a {
    color: var(--primary-color);
    text-decoration: none;
    transition: color var(--transition-speed);
}

a:hover {
    color: var(--secondary-color);
    text-decoration: underline;
}

.table {
    margin: 16px 0;
}

.table h3 {
    margin: 8px 0;
    color: var(--text-color);
}

.table-description {
    font-style: italic;
    color: var(--text-secondary-color);
    
    
    
}

.modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--surface-color);
    padding: 24px;
    border-radius: var(--border-radius);
    box-shadow: 0px 4px 8px var(--shadow-color);
}

.modal-link {
    font-weight:400;
    cursor:pointer;
    text-decoration: underline dotted;
    
}
.modal-link.plot-content {
        color:#Primary;
    
}
.modal-link.friendship-content {
    color:#4F378B;
}
.modal-link.rivalry-content {
    color:#ff7600;
}
.modal-link.hatred-content {
    color:#7e0000;
}
.modal-link.love-content {
    color:#633B48;
}
.modal-link.despondent-content {
    color:#2f52ff;
}

.modal.active {
    display: block;
}

.ui-dialog.ui-widget-content {
    min-width:35vw;
}

.accordion-content {
    max-height: 0; /* Start collapsed */
    overflow: hidden;
    transition: max-height 0.3s ease; /* Smooth open/close */
}

.accordion-content.open {
    max-height: 1000px; /* A large enough value to fit any content */
    padding: 12px; /* Add top/bottom padding when expanded */
}

.tooltip {
    position: relative;
    cursor: help; /* Indicates additional information */
    color: var(--primary-color); /* Optional: Highlight tooltip words */
    text-decoration: underline; /* Optional: Underline tooltip words */
}

.tooltip::after {
    content: attr(data-tooltip); /* Use the data-tooltip attribute */
    position: absolute;
    top: 100%; /* Position below the word */
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--surface-color); /* Background of the tooltip */
    color: var(--text-color); /* Text color of the tooltip */
    padding: 6px 12px;
    border-radius: 4px;
    white-space: nowrap; /* Prevent wrapping */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Optional: Add a shadow */
    font-size: 0.9rem; /* Adjust size */
    line-height: 1.2; /* Adjust spacing */
    visibility: hidden; /* Hide by default */
    opacity: 0; /* Make transparent by default */
    transition: opacity 0.3s ease, visibility 0.3s ease; /* Smooth transition */
    z-index: 10; /* Ensure it appears above other content */
}

.tooltip:hover::after {
    visibility: visible; /* Show on hover */
    opacity: 1; /* Fade in */
}

.tooltip {
    position: relative;
    cursor: help;
    color: var(--primary-color);
    text-decoration: underline;
}

.tooltip::after {
    content: attr(data-tooltip); /* Use the data-tooltip attribute */
    position: absolute;
    top: 100%; /* Position below the word */
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--surface-color); /* Background of the tooltip */
    color: var(--text-color); /* Text color of the tooltip */
    padding: 8px 16px; /* Increase padding for better readability */
    border-radius: 4px;
    white-space: normal; /* Allow wrapping */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Optional: Add a shadow */
    font-size: 0.9rem; /* Adjust size */
    line-height: 1.4; /* Improve spacing for readability */
    visibility: hidden; /* Hide by default */
    opacity: 0; /* Make transparent by default */
    transition: opacity 0.3s ease, visibility 0.3s ease; /* Smooth transition */
    z-index: 10; /* Ensure it appears above other content */
    max-width: 400px; /* Wider tooltip for desktop */
    min-width: 200px; /* Prevent overly narrow tooltips */
    width: auto; /* Let width adapt to content */
    max-width: 80vw; /* Stay responsive for



.tooltip:hover::after {
    visibility: visible; /* Show on hover */
    opacity: 1; /* Fade in */
}


.dynamic-tooltip {
    position: absolute;
    background-color: var(--surface-color, #ffffff); /* Fallback to white if no surface color is set */
    color: var(--text-color, #000000); /* Fallback to black if no text color is set */
    padding: 8px 12px;
    border-radius: 4px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
    font-size: 0.9rem;
    line-height: 1.4;
    z-index: 1000;
    max-width: 300px;
    white-space: normal;
    visibility: visible;
    opacity: 1;
    transition: opacity 0.3s ease;
}

.tooltip:hover + .dynamic-tooltip, .tooltip:focus + .dynamic-tooltip {
    visibility: visible;
    opacity: 1;
}





@media (max-width: 600px) {
    textarea, input[type="number"], button, .event {
        width: calc(100% - 32px);
        max-width: 100%;
    }

    h1 {
        font-size: 1.5rem;
    }

    h2 {
        font-size: 1.25rem;
    }
}

.accordion {
    
    margin: 0 auto;
}

.accordion-header {
    background-color: var(--secondary-color);
    color: #000000;
    cursor: pointer;
    border: none;
    text-align: center;
    padding: 10px;
    font-weight: 500;
    width: 200px;
    font-size: 1rem;
    transition: background-color 0.5s ease;
    border-radius: var(--border-radius);
    margin: 4px 0;
    
}

.accordion-header:hover {
    background-color: #018786;
}

.flavor-text {
    font-family: 'Noto Serif', serif; /* Use Noto Serif */
    font-style: italic; /* Make it italic for emphasis */
    color: var(--text-secondary-color); /* Use a secondary text color */
    background-color: var(--surface-color); /* Subtle background */
    padding: 10px 16px; /* Add space around the text */
    border-radius: 4px; /* Smooth, rounded edges */
    margin: 8px 0; /* Space around the element */
    font-size: .8rem; /* Adjust size for readability */
    box-shadow: 0px 2px 4px var(--shadow-color); /* Optional: light shadow */
    line-height: 1.6; /* Improve readability */
    max-width: 600px; /* Optional: Limit width for better design */
}
/* border-left: 4px solid var(--primary-color); /* Modern colored accent */ 

.keyword-reminder {
   
    background-color: var(--surface-color); /* Subtle background */
    padding: 10px 16px; /* Add space around the text */
    border-radius: 4px; /* Smooth, rounded edges */
    margin: 8px 0; /* Space around the element */
    font-size: .9rem; /* Adjust size for readability */
    box-shadow: 0px 2px 4px var(--shadow-color); /* Optional: light shadow */
    line-height: 1.4; /* Improve readability */
    max-width: 600px; /* Optional: Limit width for better design */
    border-left: 4px solid var(--secondary-color); /* Modern colored accent */ 
    list-style-type: disc;
    padding-left: 30px;
    
}


#tooltip-container {
    position: absolute;
    background-color: var(--surface-color);
    color: var(--text-color);
    padding: 8px 12px;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    font-size: 0.9rem;
    line-height: 1.5;
    z-index: 1000;
    display: none; /* Hidden by default */
    max-width: 300px;
    white-space: normal; /* Allow wrapping */
}



    </style>
    <!-- Google Hosted jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- Google Hosted jQuery UI with default Smoothness theme -->
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.14.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"></script>


    <script>
const tables = {
    "Meeting Location": {
        description:
            "Roll 1d20 to determine where two characters meet up. P. 75",
        dice: { number: 1, sides: 20 },
        outcomes: {
            1: "Bar / Nightlife",
            2: "Bar / Nightlife",
            3: "Bar / Nightlife",
            4: "Restaurant",
            5: "Restaurant",
            6: "Restaurant",
            7: "Concert / Music Venue",
            8: "Concert",
            9: "Concert",
            10: "Formal ball",
            11: "Formal ball",
            12: "Park",
            13: "Park",
            14: "Park",
            15: "Military base",
            16: "Military base",
            17: "Military base",
            18: "Private residence",
            19: "Private residence",
            20: "Private residence",
        },
    },

    "Initial Reaction - p.76": {
        description:
            "If the characters have no known feelings about each other, roll 2d6 to see how their first meeting turns out. (P. 76)",
        dice: { number: 2, sides: 6 }, // Use 2d6 for this table
        outcomes: {
            2: "Things get heated. They do not get along one bit. They are now Rivals. When becoming Rivals, each character immediately receives +1 XP.🆚",
            3: "Things get heated. They do not get along one bit. They are now Rivals. When becoming Rivals, each character immediately receives +1 XP.🆚",
            4: "Things get heated. They do not get along one bit. They are now Rivals.🆚 When becoming Rivals, each character immediately receives +1 XP.",
            5: "Things get heated. They do not get along one bit. They are now Rivals.🆚 When becoming Rivals, each character immediately receives +1 XP.",
            6: "The two characters share a few moments appropriate to the location, then go their separate ways. No change in status.",
            7: "Roll 1d20 for an Unexpected Event.❔  ([1d20])",
            8: "The two characters spend some time together and get along well. The two characters are now Friends.👥 When becoming Friends, each character immediately receives +1 XP.",
            9: "The two characters spend some time together and get along well. The two characters are now Friends.👥 When becoming Friends, each character immediately receives +1 XP.",
            10: "The two characters spend some time together and get along well. The two characters are now Friends.👥 When becoming Friends, each character immediately receives +1 XP.",
            11: "The two characters spend some time together and get along well. The two characters are now Friends.👥 When becoming Friends, each character immediately receives +1 XP.",
            12: "The two characters spend some time together and get along well. The two characters are now Friends.👥 When becoming Friends, each character immediately receives +1 XP.",
        },
    },

    "Unexpected Event❔ p.76": {
        description: "P. 76",
        dice: { number: 1, sides: 20 }, // Use 1d20
        outcomes: {
            1: "One of the characters is depressed and upset about something. Roll 1D6 ([1d6]) for the character and 1D6 ([1d6]) for the person they are meeting. If the latter roll higher, the two become Friends and are no longer Despondent if they were before. If the roll is a draw or the depressed character rolls higher, they become Despondent.",
            2: "One of the characters is depressed and upset about something. Roll 1D6 ([1d6]) for the character and 1D6 ([1d6]) for the person they are meeting. If the latter roll higher, the two become Friends and are no longer Despondent if they were before. If the roll is a draw or the depressed character rolls higher, they become Despondent.",
            3: "If either (or both) characters have any Friends, they are going through a temporary disagreement. They will not count as Friends for this or the following campaign turns. Should the two meet during that time, they are counted as rivals.",
            4: "If meeting in public, the two characters get into some sort of trouble! A Pilot above 2nd Lieutenant rank must roll 2D6 ([2d6]) and score a 7+ to avoid demotion. Staff are not affected and nothing happens if they met in private.",
            5: "Gossip is spreading. Roll 1D6. ([1d6]) On a 1 it is harmless. On a 2-4 one of the characters develops a rivalry with a random character that isn't a friend or loved one. On a 5-6 both of the characters develop a rivalry with a random character as above.",
            6: "One of the characters has a grand ambition they want to pursue, such as becoming a singer or being a star of the nightlife. The character becomes ⭐️Plot Important. Randomly determine what location the ambition is tied to. ({MeetingLocation}) Every time the character goes to this location, roll a D6: On a 5-6 they achieve their ambition and receive +2 XP",
            7: "One of the characters has a grand ambition they want to pursue, such as becoming a singer or being a star of the nightlife. The character becomes ⭐️Plot Important. Randomly determine what location the ambition is tied to. ({MeetingLocation}) Every time the character goes to this location, roll a D6: On a 5-6 they achieve their ambition and receive +2 XP",
            8: "One of the characters has a grand ambition they want to pursue, such as becoming a singer or being a star of the nightlife. The character becomes ⭐️Plot Important. Randomly determine what location the ambition is tied to. ({MeetingLocation}) Every time the character goes to this location, roll a D6: On a 5-6 they achieve their ambition and receive +2 XP",
            9: "One of the characters has a grand ambition they want to pursue, such as becoming a singer or being a star of the nightlife. The character becomes ⭐️Plot Important. Randomly determine what location the ambition is tied to. ({MeetingLocation}) Every time the character goes to this location, roll a D6: On a 5-6 they achieve their ambition and receive +2 XP",
            10: "If either or both characters are Despondent😖, a hearty pep talk (or complaining session) snaps them out of it. If neither were, one of them receives +1 XP for hearing exactly what they needed to hear today.",
            11: "If either or both characters are Despondent😖, a hearty pep talk (or complaining session) snaps them out of it. If neither were, one of them receives +1 XP for hearing exactly what they needed to hear today.",
            12: "If one of the characters have a Friend👥 or True Love, they introduce the other character in the encounter to one such person (chosen at random if there are multiple). The two characters being introduced become Friends👥.",
            13: "If one of the characters have a Friend👥 or True Love, they introduce the other character in the encounter to one such person (chosen at random if there are multiple). The two characters being introduced become Friends👥.",
            14: "If one of the characters have a Friend👥 or True Love, they introduce the other character in the encounter to one such person (chosen at random if there are multiple). The two characters being introduced become Friends👥.",
            15: "While hanging out, a third person shows up. [{randomName}] Randomly select someone and have everyone react to everyone present, in any order you like. (Click the button again to clear this and generate more  Encounters.)",
            16: "While hanging out, a third person shows up. [{randomName}] Randomly select someone and have everyone react to everyone present, in any order you like. (Click the button again to clear this and generate more  Encounters.)",
            17: "While hanging out, a third person shows up. [{randomName}] Randomly select someone and have everyone react to everyone present, in any order you like. (Click the button again to clear this and generate more  Encounters.)",
            18: "While hanging out, a third person shows up. [{randomName}] Randomly select someone and have everyone react to everyone present, in any order you like. (Click the button again to clear this and generate more  Encounters.)",
            19: "After a bit of a motivating discussion, one of the characters selected at random may take a Personal Action. (Character #[1d2], see p. 81)",
            20: "After a bit of a motivating discussion, one of the characters selected at random may take a Personal Action. (Character #[1d2], see p. 81)",
        },
    },

    "Meeting a Friend👥 - p.79": {
        description:
            "When two friends run into each other, roll 2d6 to determine the what happens.",
        dice: { number: 2, sides: 6 }, // Use 2d6 for this table
        outcomes: {
            2: "One of the characters introduces their friend to someone. Randomly select a character that is not a rival to either. [{randomName}] They become Friends👥 with <i>both</i> characters.",
            3: "One of the characters introduces their friend to someone. Randomly select a character that is not a rival to either. [{randomName}] They become Friends👥 with <i>both</i> characters.",
            4: "One of the characters introduces their friend to someone. Randomly select a character that is not a rival to either. [{randomName}] They become Friends👥 with <i>both</i> characters.",
            5: "The two characters spend some time together at the chosen location and have a pleasant day off.",
            6: "The two characters spend some time together at the chosen location and have a pleasant day off.",
            7: "The two characters spend some time together at the chosen location and have a pleasant day off.",
            8: "The two have a heart to heart moment. They share some profound wisdom. Each character receives +1 XP.",
            9: "The two have a heart to heart moment. They share some profound wisdom. Each character receives +1 XP.",
            10: "One of the characters confesses that they are in Love💘 with someone! (It is Character #[1d2], they desire [#1d6]) <br>Roll 1D6: On a 1-3 it is the character they are meeting. On a 4-6 it is a randomly selected character.",
            11: "One of the characters confesses that they are in Love💘 with someone! (It is Character #[1d2], they desire [#1d6]) <br>Roll 1D6: On a 1-3 it is the character they are meeting. On a 4-6 it is a randomly selected character.",
            12: "The two meeting  characters are now in Love💘 whether they want it or not.",
        },
    },

    "Meeting a Lover💘 - 80": {
        description:
            "Whenever two characters that are in Love meet, do not roll. The one with the fewest XP gains +1XP.<br>If a character is in Love with someone that does <b>not</b> return it, roll 2d6 to see what happens.(p. 80) The Unrequited Love table is below.",
        dice: { number: 2, sides: 6 }, // Use 2d6 for this table
        outcomes: {
            2: "The character confesses and makes a complete fool of themselves. They become Despondent😖 as they flee the encounter.<br> If the two characters meet again roll 1D6: ([1d6]) On a 1, the Love is over and the character remains Despondent. On a 2 they recover and are no longer Despondent or in Love. On a 3, they recover and remain in Love. On a 4-6 the other character reciprocates and the two are now in love.",
            3: "3-6: The character fumbles around and acts like a fool, while the recipient remains none the wiser. <br>Roll 1D6 ([1d6]) with a 1-2 indicating the character in Love becomes Despondent😖.",
            4: "3-6: The character fumbles around and acts like a fool, while the recipient remains none the wiser. <br>Roll 1D6 ([1d6]) with a 1-2 indicating the character in Love becomes Despondent😖.",
            5: "3-6: The character fumbles around and acts like a fool, while the recipient remains none the wiser. <br>Roll 1D6 ([1d6]) with a 1-2 indicating the character in Love becomes Despondent😖.",
            6: "3-6: The character fumbles around and acts like a fool, while the recipient remains none the wiser. <br>Roll 1D6 ([1d6]) with a 1-2 indicating the character in Love becomes Despondent😖.",
            7: "The character confesses but is turned down gently. They are no longer in love.",
            8: "The character confesses and the other character reciprocates. True romance kicks in. <b>Both</b> characters gain +3XP and become ⭐️Plot Important.",
            9: "The character confesses and the other character reciprocates. True romance kicks in. <b>Both</b> characters gain +3XP and become ⭐️Plot Important.",
            10: "The character confesses and the other character reciprocates. True romance kicks in. <b>Both</b> characters gain +3XP and become ⭐️Plot Important.",
            11: "The character confesses and the other character reciprocates. True romance kicks in. <b>Both</b> characters gain +3XP and become ⭐️Plot Important.",
            12: "The character confesses and the other character reciprocates. True romance kicks in. <b>Both</b> characters gain +3XP and become ⭐️Plot Important.",
        },
    },
    "Meeting a Rival🆚 - p.78": {
        description:
            "When two rivals encounter each other, roll 2D6 to determine the what happens. (p. 78)",
        dice: { number: 2, sides: 6 }, // Use 2d6 for this table
        outcomes: {
            2: "Confrontation: A brawl, screaming match or similar breaks out. <br> If the meeting takes place in public, a randomly selected character may intervene on a 2D6 roll of 9+. ([{randomName}] rolls a [[2d6]].) <br>If they succeed and are a rival of either character, the rival will now hate the interventor. <br>Otherwise, they can prevent the confrontation escalating and send everybody home. <br> If the confrontation goes on without intervention, it results in a disciplinary review. Roll 2D6 for each character. (Character #1: [[2d6]], Character #2: [[2d6]]) <br> Staff is dismissed from the service on a roll of 2-4 while Pilots are demoted one rank (and dismissed if already the lowest rank). If both characters remain, a final 2D6 roll is made. [[2d6]] On a 2-5 they will now Hate😡 each other while on an 10-12 they finally got it out of their systems and are no longer Rivals.",
            3: "Confrontation: A brawl, screaming match or similar breaks out. <br> If the meeting takes place in public, a randomly selected character may intervene on a 2D6 roll of 9+. ([{randomName}] rolls a [[2d6]].) <br>If they succeed and are a rival of either character, the rival will now hate the interventor. <br>Otherwise, they can prevent the confrontation escalating and send everybody home. <br> If the confrontation goes on without intervention, it results in a disciplinary review. Roll 2D6 for each character. (Character #1: [[2d6]], Character #2: [[2d6]]) <br> Staff is dismissed from the service on a roll of 2-4 while Pilots are demoted one rank (and dismissed if already the lowest rank). If both characters remain, a final 2D6 roll is made. [[2d6]] On a 2-5 they will now Hate😡 each other while on an 10-12 they finally got it out of their systems and are no longer Rivals.",
            4: "Shouting Match: This could go wrong really soon. If the characters met in private, then this is near one of their private residences; randomly determine whose it is. (It belongs to character #[1d2]). The character at home rolls 1D6 with a 4-6 ending the encounter. [[1d6]] Otherwise roll 1D6 again treating a [[1d6]] 1-3 as a Confrontation (above) and 4-6 as a Fierce Argument (below). (I don't know how to program this, so just hit the  button or check page 78.)",
            5: "Showing Match: This could go wrong really soon. If the characters met in private, then this is near one of their private residences; randomly determine whose it is. (It belongs to character #[1d2]). The character at home rolls 1D6 with a 4-6 ending the encounter. [[1d6]] Otherwise roll 1D6 again treating a [[1d6]] 1-3 as a Confrontation (above) and 4-6 as a Fierce Argument (below). (I don't know how to program this, so just hit the  button or check page 78.)",
            6: "The characters have it out. <br>Each character must roll 2D6. (Character #1: [[2d6]], Character #2: [[2d6]]) <br>On a 2-4 they now Hate😡 their rival. If this happens in a public location, you may roll 8+ on 2D6  to have a randomly selected character show up. ([[2d6]], [{randomName}]) <br>If they are NOT Rivals with either character, they allow both Rivals to reroll the check to see if they develop a Hatred. <br>If the newcomer <i>is</i> a Rival of either character, the Rival in the argument will now Hate😡 the newcomer for ganging up on them.",
            7: "The characters have it out. <br>Each character must roll 2D6. (Character #1: [[2d6]], Character #2: [[2d6]]) <br>On a 2-4 they now Hate😡 their rival. If this happens in a public location, you may roll 8+ on 2D6  to have a randomly selected character show up. ([[2d6]], [{randomName}]) <br>If they are NOT Rivals with either character, they allow both Rivals to reroll the check to see if they develop a Hatred. <br>If the newcomer <i>is</i> a Rival of either character, the Rival in the argument will now Hate😡 the newcomer for ganging up on them.",
            8: "Tense scene: <br>The room goes <i>quiet</i>. If nobody intervenes, the characters remain rivals. If the meeting is in a public location, you may opt to have another character intervene. Randomly select who is on the scene [{randomName}] and roll 1D6: [[1d6]] <br>On a 1 both characters become Rivals🆚 of the newcomer but they set aside their own rivalry. <br>On a 2, one of the two having tension [Character #[1d2]] become Rivals🆚 of the newcomer. <br>On a 3-4 nothing happens. <br>On a 5-6, the rivalry is ended.",
            9: "Tense scene: <br>The room goes <i>quiet</i>. If nobody intervenes, the characters remain rivals. If the meeting is in a public location, you may opt to have another character intervene. Randomly select who is on the scene [{randomName}] and roll 1D6: [[1d6]] <br>On a 1 both characters become Rivals🆚 of the newcomer but they set aside their own rivalry. <br>On a 2, one of the two having tension [Character #[1d2]] become Rivals🆚 of the newcomer. <br>On a 3-4 nothing happens. <br>On a 5-6, the rivalry is ended.",
            10: "After a long talk, the characters manage to resolve their differences. They are no longer considered to be rivals.",
            11: "After a long talk, the characters manage to resolve their differences. They are no longer considered to be rivals.",
            12: "After a long talk, the characters manage to resolve their differences. They are no longer considered to be rivals.",
        },
    },

    "Hatred😡 - p.79": {
        description:
            "Hatreds are rarely resolved. If characters who Hate meet each other, roll 2D6 and use this table in place of the normal reaction roll.",
        dice: { number: 2, sides: 6 }, // Use 2d6 for this table
        outcomes: {
            2: "One of the two characters selected at random, ([Character #[[1d2]]) leaves the campaign.",
            3: "One of the two characters selected at random, ([Character #[[1d2]]) leaves the campaign.",
            4: "One of the two characters selected at random, ([Character #[[1d2]]) leaves the campaign.",
            5: "Ugly words. No change in status.",
            6: "Cruel words. No change in status.",
            7: "Intense words. No change in status.",
            8: "Violence. No change in status.",
            9: "The Hatred recedes to a Rivalry🆚.",
            10: "The Hatred recedes to a Rivalry🆚.",
            11: "The Hatred recedes to a Rivalry🆚.",
            12: "The Hatred is resolved and the characters become neutral.",
        },
    },
};

// run on doc load
$(document).ready(function () {
    attachModals(); // build jquery dialogs
    listenModals();
});

// attachModals() -
// - add jquery dialogs to the accordion content areas
// - these are triggered later
function attachModals() {
    $(".accordion-content").each(function () {
        const self = $(this), // the reference rules for each modal
            accTitle = self.attr("data-modal"), // the title of the rule (ex: Plot Important)
            accId = self.attr("data-modal-id"),
            accContent = self.html(); // modal content

        const accModal = self.clone().attr('id',accId).dialog({
            title: accTitle,
            autoOpen: false,
        });
    });
}

function listenModals() {
    $("#events").on("click", ".modal-link", function () {
        const self = $(this),
            linkModal = self.attr("data-modal"),
            modalId = self.attr("data-modal-id"),
            theModal = $("#" + modalId + "");
        console.log("theModal = " + theModal);
        console.log("modalId = " + modalId);
        //theModal = $('.accordion-content[data-modal="' + linkModal + '"]');
        theModal.dialog("open");
        console.log("open modal");
    });
}

function rollDice(dice, sides) {
    let total = 0;
    for (let i = 0; i < dice; i++) {
        total += Math.floor(Math.random() * sides) + 1;
    }
    return total;
}

function rollOnTable(table) {
    const { number, sides } = table.dice;
    const roll = rollDice(number, sides);
    return table.outcomes[roll] || "Unknown location";
}





function getRandomName(names) {
    if (names.length === 0) return "Unknown Character";
    return names[Math.floor(Math.random() * names.length)];
}

function toggleAccordion(button) {
    const content = button.nextElementSibling;

    // Toggle the clicked accordion section
    if (content.style.maxHeight) {
        content.style.maxHeight = null; // Collapse if already expanded
    } else {
        content.style.maxHeight = content.scrollHeight + "px"; // Expand to fit content
    }
}

const tooltipContainer = document.getElementById("tooltip-container");

// Attach hover events to elements with the tooltip class
document.querySelectorAll(".tooltip").forEach((tooltip) => {
    tooltip.addEventListener("mouseover", (event) => {
        const htmlContent = tooltip.getAttribute("data-tooltip-html");
        if (htmlContent) {
            tooltipContainer.innerHTML = htmlContent; // Set HTML content
            tooltipContainer.style.display = "block";

            const rect = tooltip.getBoundingClientRect();
            tooltipContainer.style.top = `${rect.bottom + window.scrollY}px`;
            tooltipContainer.style.left = `${
                rect.left + window.scrollX + rect.width / 2
            }px`;
            tooltipContainer.style.transform = "translateX(-50%)";
        }
    });

    tooltip.addEventListener("mouseout", () => {
        tooltipContainer.style.display = "none";
        tooltipContainer.innerHTML = ""; // Clear content
    });
});

// this one is super important!!!!!!!!!!!!
// function wrapTooltip(word, tooltipText) {
//     return `<span class="tooltip" data-tooltip="${tooltipText.replace(
//         /\n/g,
//         "<br>"
//     )}">${word}</span>`;
// }

function wrapModalLink(word, modal, id) {
    return (
        '<span class="modal-link ' +
        id +
        '" data-modal="' +
        modal +
        '" data-modal-id="' +
        id +
        '">' +
        word +
        "</span>"
    );
}

function generateEvents() {
    const names = document
        .getElementById("nameList")
        .value.trim()
        .split("\n")
        .filter((name) => name.trim() !== "");

    if (names.length < 2) {
        alert("Please enter at least two names!");
        return;
    }

    const encounterCount = parseInt(
        document.getElementById("encounterCount").value,
        10
    );
    if (isNaN(encounterCount) || encounterCount < 1) {
        alert("Please enter a valid number of encounters!");
        return;
    }

    const eventsContainer = document.getElementById("events");
    eventsContainer.innerHTML = "";

    for (let i = 0; i < encounterCount; i++) {
        const pair = names.sort(() => 0.5 - Math.random()).slice(0, 2);
        const pairDiv = document.createElement("div");
        pairDiv.classList.add("event");
        pairDiv.innerHTML = `<h2>Encounter ${i + 1}: ${pair[0]} and ${
            pair[1]
        }</h2>`;

        Object.entries(tables).forEach(([tableName, table]) => {
            const { number, sides } = table.dice;
            const roll = rollDice(number, sides);
            let outcome = table.outcomes[roll] || "Unknown outcome";

            outcome = outcome.replace(/\bplot important(s)?\b/gi, (match) =>
                wrapModalLink(match, "Plot Important", "plot-content")
            );
            outcome = outcome.replace(/\brival(s)?\b/gi, (match) =>
                wrapModalLink(match, "Rivalry", "rivalry-content")
            );
            outcome = outcome.replace(/\bfriendship(s)?\b/gi, (match) =>
                wrapModalLink(match, "Friendship", "friendship-content")
            );
            outcome = outcome.replace(/\bfriend(s)?\b/gi, (match) =>
                wrapModalLink(match, "Friendship", "friendship-content")
            );
            outcome = outcome.replace(/\bhatred(s)?\b/gi, (match) =>
                wrapModalLink(match, "Hatred", "hatred-content")
            );
            outcome = outcome.replace(/\blove(s)?\b/gi, (match) =>
                wrapModalLink(match, "Love", "love-content")
            );
            outcome = outcome.replace(/\bdespondent(s)?\b/gi, (match) =>
                wrapModalLink(match, "Despondent", "despondent-content")
            );

            // Replace dice rolls like [XdY]
            outcome = outcome.replace(
                /\[(\d+)d(\d+)\]/g,
                (match, dice, sides) => {
                    return rollDice(parseInt(dice), parseInt(sides));
                }
            );

            // Replace `{randomName}` with a random name
            outcome = outcome.replace(/{randomName}/g, () =>
                getRandomName(names)
            );

            outcome = outcome.replace(/{MeetingLocation}/g, () =>
                rollOnTable(tables["Meeting Location"])
            );

            const tableDiv = document.createElement("div");
            tableDiv.classList.add("table");
            tableDiv.innerHTML = `
                <h3>${tableName}</h3>
                
                <p><i>${roll}</i> : ${outcome}</p>
            `;
            pairDiv.appendChild(tableDiv);
        });

        // <p class="table-description">${table.description}</p>

        eventsContainer.appendChild(pairDiv);
    }
}

    </script>    
</head>
<body>
  
  

<div style="height: 50px;"></div>


    <h1>WEZLTECH - Social System Generator</h1>
    <div>
      This is a web tool to help facilitate campaigns of <a href="https://www.wargamevault.com/product/379784/WeaselTech-High-Octane-Cybernetic-Warfare?filters=0_0_0_0_0_1000165">Weasel-Tech, by Nordic Weasel Games</a>. Weasel-Tech is a solo/coop miniatures-agnostic wargame designed to emulate the high-speed mecha warfare found in <i>Gundam, Macross, Front Mission, and Armored Core.</i>
      <br>Questions or comments? <a href="https://linktr.ee/warlore">Hit me up.</a>
        <h2>INSTRUCTIONS</h2>
        <p>Fill in your characters, choose the number of encounters (default is 2 per mission, but you can create more to refer to if more rolls are needed) and click the button.</p>
        <br>Use your existing context, notes, and relationships between characters to determine which result you use. <b>Don't just use every rolled result.</b></p>
    </div>

    <p>Number of encounters to generate:</p>
    <input type="number" id="encounterCount" value="3" min="1" max="10">

    <p>Enter names below (one name per line):</p>
    <textarea id="nameList" rows="5">
        Char Aznable
        Zechs Merquise
        Rau Le Creuset
        Full Frontal
        Chronicle Asher
        Schwarz Bruder
        Harry Ord
        Neo Roanoke
        Mr. Bushido
        McGillis Fareed
        Lady Prospera
        Jamil Neate
        Graham Aker
        Boris Schauer
        Zeaheart Galette
    </textarea>
    <br>
    <button onclick="generateEvents()">Generate Random Encounters!</button>
    <div id="events"></div>


    
    <br>
    <h3>RELATIONSHIP REFERENCE:</h3>
    
    <div>
    
        <div class="accordion">

            <button class="accordion-header" onclick="toggleAccordion(this)">⭐️ Plot Important</button>
            <div class="accordion-content" data-modal-id="plot-content" data-modal="Plot Important">
                <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                    Certain events would not happen unless the character is important to the plot somehow.
                </p>
                <p class="keyword-reminder">A +1 bonus applies when rolling for Pilot survival if a character is Plot Important due to results from this chapter.</p>
            </div>
  
  
            <button class="accordion-header" onclick="toggleAccordion(this)">👥 Friendship</button>
   
            <div class="accordion-content" data-modal-id="friendship-content" data-modal="Friendship">
                <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                    Making friends is important.
                </p>
                <ul class="keyword-reminder">
                    <li>When becoming Friends, each character immediately receives +1 XP.</li>
                    <li>A Pilot accompanying a friend into battle may add +1 when rolling on the post-mission Pilot survival table.</li>
                    <li>A Pilot sent to rescue a friend may count their Experience Level as +1 higher than normal.</li>
                    <li>Pilots being friends with Command Staff has its advantages. When the Command Staff would directly benefit a friend, their Staff Level is counted +1 higher than normal (though not exceeding the normalmaximum).</li>
                    <li>Staff friendships with other Staff has no direct benefits."</li>
                </ul>
            </div>
    
            <button class="accordion-header" onclick="toggleAccordion(this)">🆚 Rivalry</button>
   
            <div class="accordion-content" data-modal-id="rivalry-content" data-modal="Rivalry">
                <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                    Rivalry often stems from ambition.
                </p>
                <ul class="keyword-reminder"><li>When becoming Rivals, each Rival immediately receives +1 XP.</li>
                    <li>Pilots cannot receive the <b>Cross Fire</b> bonus ifthe target is being fired upon by a rival Pilot.</li>
                    <li>A Pilot sent to rescue a rival must count their Experience Level as 1 lower than normal.</li>
                    <li>If a Pilot has a rivalry with Command Staff, any actions directly affecting the rival must count the Staff Level as being 1 point lower than normal. Staff rivalries with other Staff has no direct effects.</li>
                    <li>A character with rivals is always ⭐️Plot Important."</li>
                </ul>
            </div>



            <button class="accordion-header" onclick="toggleAccordion(this)">😡 Hatred</button>
            
            <div class="accordion-content" data-modal-id="hatred-content" data-modal="Hatred">
                    <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                        Hatred is a corrosive force that will undermine any military organization.
                    </p>

                    <ul class="keyword-reminder">
                        <li>If a hatred develops between two Pilots, they will refuse to be in the same Strike Force.</li>
                        <li>If Staff hates a Pilot or vice versa, no Staff bonuses can be applied to rolls directly affecting the Pilot.</li>
                        <li>Staff that hate each other will refuse to work together. Each mission you must select  which of the two Staff can apply their Staff Level.</li>
                    </ul>
                
                </div>


            <button class="accordion-header" onclick="toggleAccordion(this)">💘 Love</button>
            
            <div class="accordion-content" data-modal-id="love-content" data-modal="Love">
                    <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                        When love strikes, it may initially be one-sided or returned. Love conquers all, they say.
                    </p>
                    <ul class="keyword-reminder">
                        <li>If two characters love each other, then true Romance has occurred.</li>
                        <li>Each character immediately receives +3 XP and both become ⭐ Plot Important characters.  They receive all benefits of being Friends👥 and <i>cannot</i> later become rivals or end up hating each other.</li>
                        <li>Staff that hate each other will refuse to work together. Each mission you must select  which of the two Staff can apply their Staff Level.</li>
                        <li><i>Love and Death</i> : Should either character be killed, the survivor must roll 1D6.<br></li>
                            On a 1-3, they become Despondent😖. On a 4-6 they move on.<br>
                            If the character would be in a situation involving love again, a 1D6 roll is made. On a 1-3 they refuse and will not engage in any new
                            relationship.
                        <li><i>Unrequieted Love:</i> If a character is in love with someone that does not return it, every time the two meet a 2D6 roll (see p. 80) is made instead. This is currently factored in the tables above. </li>
                    
                        <li><i>Love with a Rival :</i>    
                            <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                                If a character falls in love with a rival, they are in for a hard time.
                            </p>  
                            When the two meet, if they have a tense scene that does not escalate or they resolve their rivalry, the character may roll on the love reaction table above (p.80) at a -1 modifier to the roll. Love being reciprocated or the character confessing being turned down gently ends the rivalry, and both characters receive +1 XP.
                        </li>
                    </ul>
                </div>

                <button class="accordion-header" onclick="toggleAccordion(this)">😖 Despondent</button>
            
            <div class="accordion-content" data-modal-id="despondent-content" data-modal="Despondent">
                    <p style="font-size: 80%; font-family: 'Noto Serif', serif; font-style: italic;">
                        A despondent character is in the depths of emotional distress. They are likely to sit around, mope and generally be completely miserable.
                    </p>

                    <ul class="keyword-reminder">
                        <li>Until they recover, they cannot gain any XP and cannot use ANY benefits of their Experience or Staff Level. (In other words, they are temporarily counted as being Level 0.)</li>
                        <li>If Staff hates a Pilot or vice versa, no Staff bonuses can be applied to rolls directly affecting the Pilot.</li>
                        <li>A Despondent character recovers if someone confesses their love to them, even if they opt not to reciprocate.</li>
                        <li>At the conclussion of a campaign, roll a d6. A Despondent character recovers on a 4+.</li>
                    </ul>  
                </div>
                <br>Other notes: See P. 80 for <b>Love Triangles</b>, 81 for <b>Personal Actions</b>.

            </div>  
        </div>

</body>
</html>
